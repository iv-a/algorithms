<h1 align="center">A. –ü–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞</h1>

<h5 align="center">
<a href="#limits">–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</a>
‚Ä¢
<a href="#task">–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏</a>
‚Ä¢
<a href="#input">–§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞</a>
‚Ä¢
<a href="#output">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</a>
‚Ä¢
<a href="#examples">–ü—Ä–∏–º–µ—Ä—ã</a>
‚Ä¢
<a href="#solution">–†–µ—à–µ–Ω–∏–µ</a>
</h5>

<br>

<table id="limits">
<tbody>
<tr>
<td>
<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏</b>
</td>
<td>
6.5 —Å–µ–∫—É–Ω–¥
</td>
</tr>
<tr>
<td>
<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b>
</td>
<td>
1Gb
</td>
</tr>
<tr>
<td>
<b>–í–≤–æ–¥</b>
</td>
<td>
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥ –∏–ª–∏ input.txt
</td>
</tr>
<tr>
<td>
<b>–í—ã–≤–æ–¥</b>
</td>
<td>
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ –∏–ª–∏ output.txt
</td>
</tr>
</tbody>
</table>

<h2 id="task">–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏</h2>

–í —ç—Ç–æ–π –∑–∞–¥–∞—á–µ –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.

–¢–∏–º–æ—Ñ–µ–π –ø–∏—à–µ—Ç —Å–≤–æ—é –ø–æ–∏—Å–∫–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.

–ò–º–µ–µ—Ç—Å—è n –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ç–µ–∫—Å—Ç –∏–∑ —Å–ª–æ–≤. –ü–æ —ç—Ç–∏–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å. –ù–∞ –≤—Ö–æ–¥ —Å–∏—Å—Ç–µ–º–µ –±—É–¥—É—Ç –ø–æ–¥–∞–≤–∞—Ç—å—Å—è –∑–∞–ø—Ä–æ—Å—ã. –ó–∞–ø—Ä–æ—Å ‚Äî‚Äì –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –Ω–∞–±–æ—Ä —Å–ª–æ–≤. –ü–æ –∑–∞–ø—Ä–æ—Å—É –Ω–∞–¥–æ –≤—ã–≤–µ—Å—Ç–∏ 5 —Å–∞–º—ã—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –±–µ—Ä—ë—Ç—Å—è —á–∏—Å–ª–æ –µ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π –≤ –¥–æ–∫—É–º–µ–Ω—Ç, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞ –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è. –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –∏ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ß–µ–º –±–æ–ª—å—à–µ —Å—É–º–º–∞, —Ç–µ–º –±–æ–ª—å—à–µ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –∑–∞–ø—Ä–æ—Å.

–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –≤—ã–¥–∞—á–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Äî‚Äì —Ç–æ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –∏—Ö –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ –≤ –±–∞–∑–µ (—Ç–æ –µ—Å—Ç—å –≤–æ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö).

–ü–æ–¥—É–º–∞–π—Ç–µ –Ω–∞–¥ —Å–ª—É—á–∞—è–º–∏, –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å—ã —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Å–ª–æ–≤, –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è –≤ –º–∞–ª–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –ß—Ç–æ –µ—Å–ª–∏ –æ–¥–Ω–æ —Å–ª–æ–≤–æ –º–Ω–æ–≥–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –æ–¥–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ?

<h2 id="input">–§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞</h2>

–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –¥–∞–Ω–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ n ‚Äî‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ (1 ‚â§ n ‚â§ 104).

–î–∞–ª–µ–µ –≤ n —Å—Ç—Ä–æ–∫–∞—Ö –¥–∞–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –æ–¥–Ω–æ–º—É –≤ —Å—Ç—Ä–æ–∫–µ. –ö–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ–≤, —Å–ª–æ–≤–∞ –æ—Ç–¥–µ–ª—è—é—Ç—Å—è –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –æ–¥–Ω–∏–º –ø—Ä–æ–±–µ–ª–æ–º –∏ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö –±—É–∫–≤. –î–ª–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç 1000 —Å–∏–º–≤–æ–ª–æ–≤. –¢–µ–∫—Å—Ç –Ω–µ –±—ã–≤–∞–µ—Ç –ø—É—Å—Ç—ã–º.

–í —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ –¥–∞–Ω–æ —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî‚Äì –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ m (1 ‚â§ m ‚â§ 104). –í —Å–ª–µ–¥—É—é—â–∏—Ö m —Å—Ç—Ä–æ–∫–∞—Ö –¥–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –ø–æ –æ–¥–Ω–æ–º—É –≤ —Å—Ç—Ä–æ–∫–µ. –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ–≤. –ó–∞–ø—Ä–æ—Å –Ω–µ –±—ã–≤–∞–µ—Ç –ø—É—Å—Ç—ã–º. –°–ª–æ–≤–∞ –æ—Ç–¥–µ–ª—è—é—Ç—Å—è –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –æ–¥–Ω–∏–º –ø—Ä–æ–±–µ–ª–æ–º –∏ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö –±—É–∫–≤. –ß–∏—Å–ª–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç 100.

<h2 id="output">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</h2>

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤—ã–≤–µ–¥–∏—Ç–µ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–æ–º–µ—Ä–∞ –ø—è—Ç–∏ —Å–∞–º—ã—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –ï—Å–ª–∏ –Ω–∞—à–ª–æ—Å—å –º–µ–Ω–µ–µ –ø—è—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Ç–æ –≤—ã–≤–µ–¥–∏—Ç–µ —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –Ω–∞—à–ª–æ—Å—å. –î–æ–∫—É–º–µ–Ω—Ç—ã —Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é 0 –≤—ã–¥–∞–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ

<h2 id="examples">–ü—Ä–∏–º–µ—Ä—ã</h2>

<h4>–ü—Ä–∏–º–µ—Ä 1</h4>
<ul>
<h6>–í–≤–æ–¥</h6>
<pre>
3
i love coffee
coffee with milk and sugar
free tea for everyone
3
i like black coffee without milk
everyone loves new year
mary likes black coffee without milk
</pre>

<h6>–í—ã–≤–æ–¥</h6>
<pre>
1 2
3
2 1
</pre>
</ul>

<hr>

<h4>–ü—Ä–∏–º–µ—Ä 2</h4>
<ul>
<h6>–í–≤–æ–¥</h6>
<pre>
6
buy flat in moscow
rent flat in moscow
sell flat in moscow
want flat in moscow like crazy
clean flat in moscow on weekends
renovate flat in moscow
1
flat in moscow for crazy weekends
</pre>

<h6>–í—ã–≤–æ–¥</h6>
<pre>
4 5 1 2 3
</pre>
</ul>

<hr>

<h4>–ü—Ä–∏–º–µ—Ä 3</h4>
<ul>
<h6>–í–≤–æ–¥</h6>
<pre>
3
i like dfs and bfs
i like dfs dfs
i like bfs with bfs and bfs
1
dfs dfs dfs dfs bfs
</pre>

<h6>–í—ã–≤–æ–¥</h6>
<pre>
3 1 2
</pre>
</ul>

<h2 id="solution">–†–µ—à–µ–Ω–∏–µ</h2>

```javascript
/*
-- –ü–†–ò–ù–¶–ò–ü –†–ê–ë–û–¢–´ --
–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞.

-- –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–û –ö–û–†–†–ï–ö–¢–ù–û–°–¢–ò --
–°–Ω–∞—á–∞–ª–∞ —Ñ—É–Ω–∫—Ü–∏–µ–π getMap —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞ wordsMap –≤—Å–µ—Ö —Å–ª–æ–≤ –∏–∑ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –∫–ª—é—á–æ–º —è–≤–ª—è–µ—Ç—Å—è —Å–ª–æ–≤–æ,
–∞ –∑–Ω–∞—á–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è –¥—Ä—É–≥–∞—è —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞ documentsMap, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –∫–ª—é—á–æ–º —è–≤–ª—è–µ—Ç—Å—è –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞,
–∞ –∑–Ω–∞—á–µ–Ω–∏–µ–º - —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –¥–∞–Ω–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ.
_______________________________________________________
  –ü—Ä–∏–º–µ—Ä:

  i love coffee
  coffee with milk and sugar
  free tea for everyone

  Map(11) {
    'i' => Map(1) { 1 => 1 },
    'love' => Map(1) { 1 => 1 },
    'coffee' => Map(2) { 1 => 1, 2 => 1 },
    'with' => Map(1) { 2 => 1 },
    'milk' => Map(1) { 2 => 1 },
    'and' => Map(1) { 2 => 1 },
    'sugar' => Map(1) { 2 => 1 },
    'free' => Map(1) { 3 => 1 },
    'tea' => Map(1) { 3 => 1 },
    'for' => Map(1) { 3 => 1 },
    'everyone' => Map(1) { 3 => 1 }
  }
_______________________________________________________

–ó–∞—Ç–µ–º, –ø–æ–ª—É—á–µ–Ω–Ω–∞—è —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞ wordsMap –≤–º–µ—Å—Ç–µ —Å –ø–æ–∏—Å–∫–æ–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ getAns.

–°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞ documents, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –∫–ª—é—á–æ–º —è–≤–ª—è–µ—Ç—Å—è –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ–º - —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å–ª–æ–≤–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏—Å—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ.

–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Å–ª–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –≤ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–µ wordsMap.

–ï—Å–ª–∏ —Å–ª–æ–≤–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–µ wordsMap –∏ –≤ –∑–∞–ø—Ä–æ—Å–µ –æ–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏–ª–æ—Å—å –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑, —Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–∑ documentsMap,
–¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–æ–ª–ª–µ–∫–∫—Ü–∏—é –≤ documents.

–ü–æ–ª—É—á–µ–Ω–Ω—É—é —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—É documents –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤, –∫–æ—Ç–æ—Ä—ã–π –≤–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏–µ–º –∑–∞–¥–∞—á–∏.

–ù–∞ –≤—ã—Ö–æ–¥–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–µ –±–æ–ª–µ–µ 5 –ø–µ—Ä–≤—ã—Ö —á–ª–µ–Ω–æ–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.

-- –í–†–ï–ú–ï–ù–ù–ê–Ø –°–õ–û–ñ–ù–û–°–¢–¨ --

–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ getSearchIndex - O(m * n), –≥–¥–µ
  n - —á–∏—Å–ª–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤;
  m - —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —Å–ª–æ–≤ –≤ –∫–∞–∂–¥–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ.

–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ getAnswer - O(k * n), –≥–¥–µ
  n - —á–∏—Å–ª–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤;
  k - —á–∏—Å–ª–æ —Å–ª–æ–≤ –≤ –ø–æ–∏—Å–∫–æ–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ.
  –¢–∞–∫ –∫–∞–∫ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ –≤—Å–µ —Å–ª–æ–≤–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –∫–∞–∂–¥–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ.

–ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞—Ä–Ω–∞—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å - O((m + k) * n);


-- –ü–†–û–°–¢–†–ê–ù–°–¢–í–ï–ù–ù–ê–Ø –°–õ–û–ñ–ù–û–°–¢–¨ --
–û–±—â–∞—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å - O(m + n), –≥–¥–µ m - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ, n - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö
—Å–ª–æ–≤ –≤–æ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö.

*/

function getAnswer(request, wordsMap) {
  const documents = new Map();
  const words = new Set();
  for (let word of request) {
    let documentsMap = wordsMap.get(word);
    if (documentsMap && !words.has(word)) {
      words.add(word);
      for (let doc of documentsMap.keys()) {
        let value = documents.get(doc);
        if (!value) {
          documents.set(doc, documentsMap.get(doc));
        } else {
          documents.set(doc, value + documentsMap.get(doc));
        }
      }
    }
  }
  const arr = Array.from(documents);
  arr.sort((a, b) => b[1] - a[1] || a[0] - b[0]);

  return arr.slice(0, TOP_RELEVANT_DOCS).map(doc => doc[0]).join(' ');
}

function getSearchIndex(documents) {
  const wordsMap = new Map();
  let docIdx = 1;
  for (let document of documents) {
    for (let word of document) {
      let documentsMap = wordsMap.get(word);
      if (!documentsMap) {
        documentsMap = new Map();
        documentsMap.set(docIdx, 1);
        wordsMap.set(word, documentsMap);
      } else {
        let documentsMapValue = documentsMap.get(docIdx);
        if (!documentsMapValue) {
          documentsMap.set(docIdx, 1);
        } else {
          documentsMap.set(docIdx, ++documentsMapValue);
        }
      }
    }
    docIdx++;
  }
  return wordsMap;
}

const readline = require('readline');
const io_interface = readline.createInterface({input: process.stdin});

let lineNumber = 0;
let numberOfDocuments, numberOfRequests;
let wordsMap;
const documents = [];
const TOP_RELEVANT_DOCS = 5;

io_interface.on('line', function (line) {
  if (lineNumber === 0) {
    numberOfDocuments = Number(line);
  } else if (lineNumber < numberOfDocuments + 1) {
    documents.push(line.split(' '));
  } else if (lineNumber === numberOfDocuments + 1) {
    numberOfRequests = Number(line);
    wordsMap = getSearchIndex(documents);
  } else if (lineNumber < numberOfDocuments + numberOfRequests + 2) {
    console.log(getAnswer(line.split(' '), wordsMap));
  }
  lineNumber++;
});
```
<table>
  <thead>
    <tr>
      <th>–í–µ—Ä–¥–∏–∫—Ç</th>
      <th>–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä</th>
      <th>–í—Ä–µ–º—è</th>
      <th>–ü–∞–º—è—Ç—å</th>
    </tr>
  </thead>
  <tbody>
<tr align="center">
<td>OK</td>
<td>Node.js 14.15.5</td>
<td>2.447s</td>
<td>71.93Mb</td>
</tr>
  </tbody>
</table>

<p width="100%" align="right"><a href="#">üîù</a></p>