<h1 align="center">J. –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ</h1>

<h5 align="center">
<a href="#limits">–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</a>
‚Ä¢
<a href="#task">–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏</a>
‚Ä¢
<a href="#input">–§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞</a>
‚Ä¢
<a href="#output">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</a>
‚Ä¢
<a href="#examples">–ü—Ä–∏–º–µ—Ä—ã</a>
‚Ä¢
<a href="#solution">–†–µ—à–µ–Ω–∏–µ</a>
</h5>

<br>

<table id="limits">
<tbody>
<tr>
<td>
<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏</b>
</td>
<td>
0.5 —Å–µ–∫—É–Ω–¥
</td>
</tr>
<tr>
<td>
<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b>
</td>
<td>
64Mb
</td>
</tr>
<tr>
<td>
<b>–í–≤–æ–¥</b>
</td>
<td>
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥ –∏–ª–∏ input.txt
</td>
</tr>
<tr>
<td>
<b>–í—ã–≤–æ–¥</b>
</td>
<td>
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ –∏–ª–∏ output.txt
</td>
</tr>
</tbody>
</table>

<h2 id="task">–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏</h2>

–ì–æ—à–∞ —Ä–µ—à–∏–ª –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ —Ç—É—Ä–Ω–µ –ø–æ –æ—Å—Ç—Ä–æ–≤–∞–º –ê–ª–≥–æ—Å—Å–∫–æ–≥–æ –∞—Ä—Ö–∏–ø–µ–ª–∞–≥–∞. –¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏—è n –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –£ i-–π –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –µ—Å—Ç—å —Å–≤–æ–π —Ä–µ–π—Ç–∏–Ω–≥ ri.

–í–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –æ—Ç i-–π –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–≤–Ω–æ –µ—ë —Ä–µ–π—Ç–∏–Ω–≥—É ri. –ì–æ—à–∞ —Ö–æ—á–µ—Ç, —á—Ç–æ–±—ã –µ–≥–æ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –æ—Ç –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π –ø–æ—Å–µ—â—ë–Ω–Ω–æ–π –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—ã–ª–æ —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π. –†–∞–¥–∏ —ç—Ç–æ–≥–æ –æ–Ω –¥–∞–∂–µ –≥–æ—Ç–æ–≤ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Å—Ç–∞ –≤ –º–∞—Ä—à—Ä—É—Ç–µ ‚Äì‚Äî –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–∞—Ä—É—à–∞—é—Ç —ç—Ç–æ—Ç –ø–æ—Ä—è–¥–æ–∫ –ø–ª–∞–≤–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è.

–ü–æ–º–æ–≥–∏—Ç–µ –ì–æ—à–µ –∏ –Ω–∞–π–¥–∏—Ç–µ –Ω–∞–∏–±–æ–ª—å—à—É—é –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â—É—é –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∞—Å—Å–∏–≤–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ ri.

<h2 id="input">–§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞</h2>

–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –¥–∞–Ω–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ n (1 ‚â§ n ‚â§ 3 ‚ãÖ 103) ‚Äì‚Äî —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç –µ—Å—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ. –í–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–µ –¥–∞–Ω–æ n –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª ‚Äì‚Äî —Ä–µ–π—Ç–∏–Ω–≥–∏ —ç—Ç–∏—Ö –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π ri (1 ‚â§ ri ‚â§ 109).

<h2 id="output">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</h2>

–°–Ω–∞—á–∞–ª–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –≤—ã–≤–µ–¥–∏—Ç–µ –¥–ª–∏–Ω—É –Ω–∞–π–¥–µ–Ω–Ω–æ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –í —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ –≤—ã–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–∑—É—é—Ç —ç—Ç—É –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

<h2 id="examples">–ü—Ä–∏–º–µ—Ä—ã</h2>

<h4>–ü—Ä–∏–º–µ—Ä 1</h4>
<ul>
<h6>–í–≤–æ–¥</h6>
<pre>
5
4 2 9 1 13
</pre>

<h6>–í—ã–≤–æ–¥</h6>
<pre>
3
1 3 5
</pre>
</ul>

<hr>

<h4>–ü—Ä–∏–º–µ—Ä 2</h4>
<ul>
<h6>–í–≤–æ–¥</h6>
<pre>
6
1 2 4 8 16 32
</pre>

<h6>–í—ã–≤–æ–¥</h6>
<pre>
6
1 2 3 4 5 6
</pre>
</ul>

<h2 id="solution">–†–µ—à–µ–Ω–∏–µ</h2>

```javascript
function findLIS(n, arr) {
  const dp = new Array(n + 1).fill(Infinity);
  const pos = new Array(n + 1);
  const prev = new Array(n);
  let length = 0;

  pos[0] = -1;
  dp[0] = -Infinity;
  for (let i = 0; i < n; i++) {
    let j = binarySearch(dp, arr[i]);
    if (dp[j - 1] < arr[i] && arr[i] < dp[j]) {
      dp[j] = arr[i];
      pos[j] = i;
      prev[i] = pos[j - 1];
      length = Math.max(length, j);
    }
  }

  let p = pos[length];
  const ans = [];
  while (p != -1) {
    ans.push(p + 1);
    p = prev[p];
  }
  ans.reverse();
  return [length, ans];
}

function binarySearch(arr, value) {
  let left = 0;
  let right = arr.length - 1;
  while (left !== right) {
    let middle = (left + right) >> 1;
    if (arr[middle] < value) {
      left = middle + 1;
    } else  {
      right = middle;
    }
  }
  return right;
}

const readline = require('readline');
const io_interface = readline.createInterface({input: process.stdin});

let lineNumber = 0;
let n;

io_interface.on('line', function (line) {
  if (lineNumber === 0) {
    n = parseInt(line, 10);
  } else if (lineNumber === 1) {
    const [length , ans] = findLIS(n, line.split(' ').map((item) => parseInt(item, 10)));
    console.log(length);
    console.log(ans.join(' '));
  }
  lineNumber++;
});
```
<table>
  <thead>
    <tr>
      <th>–í–µ—Ä–¥–∏–∫—Ç</th>
      <th>–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä</th>
      <th>–í—Ä–µ–º—è</th>
      <th>–ü–∞–º—è—Ç—å</th>
    </tr>
  </thead>
  <tbody>
<tr align="center">
<td>OK</td>
<td>Node.js 14.15.5</td>
<td>70ms</td>
<td>6.93Mb</td>
</tr>
  </tbody>
</table>

<p width="100%" align="right"><a href="#">üîù</a></p>