<h1 align="center">I. –°–ª–æ–∂–Ω–æ–µ –ø–æ–ª–µ —Å —Ü–≤–µ—Ç–æ—á–∫–∞–º–∏</h1>

<h5 align="center">
<a href="#limits">–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</a>
‚Ä¢
<a href="#task">–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏</a>
‚Ä¢
<a href="#input">–§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞</a>
‚Ä¢
<a href="#output">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</a>
‚Ä¢
<a href="#examples">–ü—Ä–∏–º–µ—Ä—ã</a>
‚Ä¢
<a href="#solution">–†–µ—à–µ–Ω–∏–µ</a>
</h5>

<br>

<table id="limits">
<tbody>
<tr>
<td>
<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏</b>
</td>
<td>
1 —Å–µ–∫—É–Ω–¥–∞
</td>
</tr>
<tr>
<td>
<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏</b>
</td>
<td>
64Mb
</td>
</tr>
<tr>
<td>
<b>–í–≤–æ–¥</b>
</td>
<td>
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥ –∏–ª–∏ input.txt
</td>
</tr>
<tr>
<td>
<b>–í—ã–≤–æ–¥</b>
</td>
<td>
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ –∏–ª–∏ output.txt
</td>
</tr>
</tbody>
</table>

<h2 id="task">–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏</h2>

–¢–µ–ø–µ—Ä—å —á–µ—Ä–µ–ø–∞—à–∫–µ –ö–æ–Ω–¥—Ä–∞—Ç–∏–Ω–µ –Ω–∞–¥–æ —É–∑–Ω–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ —Ü–≤–µ—Ç–æ—á–∫–æ–≤ –æ–Ω–∞ –º–æ–∂–µ—Ç —Å–æ–±—Ä–∞—Ç—å, –Ω–æ –∏ –∫–∞–∫ –µ–π –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ–π –º–∞—Ä—à—Ä—É—Ç –¥–ª—è —ç—Ç–æ–≥–æ. –ü–æ–º–æ–≥–∏—Ç–µ –µ–π!

–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ –ö–æ–Ω–¥—Ä–∞—Ç–∏–Ω–µ –Ω–∞–¥–æ –¥–æ–π—Ç–∏ –æ—Ç –ª–µ–≤–æ–≥–æ –Ω–∏–∂–Ω–µ–≥–æ –¥–æ –ø—Ä–∞–≤–æ–≥–æ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É–≥–ª–∞, –∞ –ø–µ—Ä–µ–¥–≤–∏–≥–∞—Ç—å—Å—è –æ–Ω–∞ —É–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ –≤–≤–µ—Ä—Ö –∏ –≤–ø—Ä–∞–≤–æ.

<h2 id="input">–§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞</h2>

–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –¥–∞–Ω—ã —Ä–∞–∑–º–µ—Ä—ã –ø–æ–ª—è n –∏ m (—á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª). –û–±–∞ —á–∏—Å–ª–∞ –ª–µ–∂–∞—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 1 –¥–æ 1000. –í —Å–ª–µ–¥—É—é—â–∏—Ö n —Å—Ç—Ä–æ–∫–∞—Ö –∑–∞–¥–∞–Ω–æ –ø–æ–ª–µ. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ m —Å–∏–º–≤–æ–ª–æ–≤ 0 –∏–ª–∏ 1 –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø–µ—Ä–µ–≤–æ–¥–æ–º —Å—Ç—Ä–æ–∫–∏. –ï—Å–ª–∏ –≤ –∫–ª–µ—Ç–∫–µ –∑–∞–ø–∏—Å–∞–Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞, —Ç–æ –≤ –Ω–µ–π —Ä–∞—Å—Ç–µ—Ç —Ü–≤–µ—Ç–æ—á–µ–∫.

<h2 id="output">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</h2>

–í—ã–≤–µ–¥–∏—Ç–µ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ—á–∫–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ —Å–º–æ–∂–µ—Ç —Å–æ–±—Ä–∞—Ç—å –ö–æ–Ω–¥—Ä–∞—Ç–∏–Ω–∞. –í–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–µ –≤—ã–≤–µ–¥–∏—Ç–µ –º–∞—Ä—à—Ä—É—Ç –≤ –≤–∏–¥–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏–º–≤–æ–ª–æ–≤ ¬´U¬ª –∏ ¬´R¬ª, –≥–¥–µ ¬´U¬ª –æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö, –∞ ¬´R¬ª ‚Äì –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏–µ –≤–ø—Ä–∞–≤–æ.

–ï—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ, —Ç–æ –≤—ã–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π.

<h2 id="examples">–ü—Ä–∏–º–µ—Ä—ã</h2>

<h4>–ü—Ä–∏–º–µ—Ä 1</h4>
<ul>
<h6>–í–≤–æ–¥</h6>
<pre>
2 3
101
110
</pre>

<h6>–í—ã–≤–æ–¥</h6>
<pre>
3
URR
</pre>
</ul>

<hr>

<h4>–ü—Ä–∏–º–µ—Ä 2</h4>
<ul>
<h6>–í–≤–æ–¥</h6>
<pre>
3 3
100
110
001
</pre>

<h6>–í—ã–≤–æ–¥</h6>
<pre>
2
UURR
</pre>
</ul>

<h2 id="solution">–†–µ—à–µ–Ω–∏–µ</h2>

```javascript
function getRoute(dp, numberOfRows, numberOfColumns) {
  let ans = [];
  let i = numberOfRows - 1;
  let j = numberOfColumns - 1;
  while (true) {
    if (i === 0 && j === 0) break;
    if (i - 1 < 0) {
      ans.push(CONSTANTS.RIGHT);
      j--;
    } else if (j - 1 < 0) {
      ans.push(CONSTANTS.UP);
      i--;
    } else {
      if (dp[i - 1][j] > dp[i][j - 1]) {
        ans.push(CONSTANTS.UP);
        i--;
      } else {
        ans.push(CONSTANTS.RIGHT);
        j--;
      }
    }
  }
  return ans.reverse().join('');
}

function solution(flowers) {
  const dp = [...Array(numberOfRows)].map(() => Array(numberOfColumns));
  for (let i = 0; i < numberOfRows; i++) {
    for (let j = 0; j < numberOfColumns; j++) {
      if (i === 0 && j === 0) {
        dp[i][j] = flowers[i][j];
      } else {
        if (i - 1 < 0) {
          dp[i][j] = dp[i][j - 1] + flowers[i][j];
        } else if (j - 1 < 0) {
          dp[i][j] = dp[i - 1][j] + flowers[i][j];
        } else {
          dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]) + flowers[i][j];
        }
      }
    }
  }
  return [dp[numberOfRows - 1][numberOfColumns - 1], getRoute(dp, numberOfRows, numberOfColumns)];
}

const readline = require('readline');
const io_interface = readline.createInterface({input: process.stdin});

let lineNumber = 0;
let numberOfRows, numberOfColumns;
let row;
const flowers = [];

const dex = 10;
const CONSTANTS = {
  UP: 'U',
  RIGHT: 'R',
};

io_interface.on('line', function (line) {
  if (lineNumber === 0) {
    [ numberOfRows, numberOfColumns ] = line.split(' ').map((item) => parseInt(item, dex));
    row = numberOfRows - 1;
  } else if (lineNumber <= numberOfRows) {
    flowers[row] = line.split('').map((item) => parseInt(item, dex));
    row--;
  }
  lineNumber++;
});

io_interface.on('close', function () {
  const [ maxFlowers, route] = solution(flowers);
  console.log(maxFlowers);
  console.log(route);
});
```
<table>
  <thead>
    <tr>
      <th>–í–µ—Ä–¥–∏–∫—Ç</th>
      <th>–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä</th>
      <th>–í—Ä–µ–º—è</th>
      <th>–ü–∞–º—è—Ç—å</th>
    </tr>
  </thead>
  <tbody>
<tr align="center">
<td>OK</td>
<td>Node.js 14.15.5</td>
<td>173ms</td>
<td>34.84Mb</td>
</tr>
  </tbody>
</table>

<p width="100%" align="right"><a href="#">üîù</a></p>